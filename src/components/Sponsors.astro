---
import { Icon } from 'astro-icon/components';
import { getCollection } from 'astro:content';

interface Props {
	eyebrow?: string;
	title?: string;
}

const { eyebrow, title } = Astro.props as Props;
const sponsorsEntries = await getCollection('sponsors');
const sponsors = sponsorsEntries.map((entry) => entry.data);
---

<script>
import { gsap } from 'gsap';

document.addEventListener('DOMContentLoaded', function () {
    const clonedContainer = document.querySelector('#cloned') as any

    Array.from(clonedContainer.children).forEach((img: any) => {
        const clone = img.cloneNode(true); 
        clonedContainer.appendChild(clone); 
    })

    const tl = gsap.timeline({ repeat: -1 });
    tl.to(clonedContainer, {
        x: -(clonedContainer.scrollWidth / 2),  duration: 30, ease: 'none'
    })
});
</script>
  
<section>
  {eyebrow && <p class="text-[0.65rem] font-semibold uppercase text-subtle m-0">{eyebrow}</p>} 
	{title && <h2 class="text-3xl sm:text-4xl font-semibold leading-tight text-ink m-0">{title}</h2>} 
    <div class="overflow-hidden p-(--grid-cell)">
        <div class="flex items-center gap-8 sm:gap-12 md:gap-16 lg:gap-24" id="cloned">
            {sponsors.map((sponsor) => (
              <div class="text-ink shrink-0 whitespace-nowrap flex items-center justify-center w-28 sm:w-36 md:w-44 lg:w-52">
                <Icon name={sponsor.icon} class="h-10 sm:h-12 md:h-14 lg:h-16 w-auto max-w-full" />
              </div>
            ))}
        </div>
    </div>
</section>